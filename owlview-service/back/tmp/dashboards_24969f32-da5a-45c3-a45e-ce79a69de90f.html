
        <html>
        <head>
          <meta charset="utf-8"/>
          <title>Дашборды опроса 24969f32-da5a-45c3-a45e-ce79a69de90f</title>
          <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
          <style>
            body {
              font-family: sans-serif;
              margin: 20px;
            }
            .chart-container {
              width: 600px;
              height: 400px;
              margin-bottom: 30px;
            }
            .question-block {
              border: 1px solid #ccc;
              padding: 15px;
              margin-bottom: 30px;
            }
            table.answer-stats {
              border-collapse: collapse;
              margin-top: 10px;
              margin-bottom: 10px;
            }
            table.answer-stats th,
            table.answer-stats td {
              border: 1px solid #ccc;
              padding: 5px 10px;
            }
          </style>
        </head>
        <body>
          <h1>Дашборды опроса 24969f32-da5a-45c3-a45e-ce79a69de90f</h1>
          <p>
            <b>Приглашены:</b> 2 |
            <b>Пройдено:</b> 2 |
            <b>Отложено:</b> 0 |
            <b>В процессе:</b> 0 |
            <b>Среднее время (мин):</b> 1.42
          </p>

          <!-- Общая диаграмма -->
          <div class="chart-container">
            <canvas id="overallChart"></canvas>
          </div>

          <!-- Контейнер для вопросов -->
          <div id="questionsBlock"></div>

          <script>
            const analyticsData = {"invited_count": 2, "completed_count": 2, "postponed_count": 0, "in_progress_count": 0, "average_time_minutes": 1.42, "question_analytics": [{"questionId": "q_1742821376445", "questionType": "q101", "title": "Как часто вы пользуетесь общественным транспортом?", "chartType": "pie", "answersDetail": [{"answerValue": "Каждый день", "count": 1, "percent": 50.0}, {"answerValue": "Несколько раз в неделю", "count": 1, "percent": 50.0}], "typedValues": [], "allRawAnswers": ["Выбрано: Каждый день |", "Выбрано: Несколько раз в неделю |"], "averageValue": null}, {"questionId": "q_1742821415471", "questionType": "q102", "title": "Какие социальные сети вы используете регулярно?", "chartType": "bar", "answersDetail": [{"answerValue": "Facebook", "count": 2, "percent": 66.7}, {"answerValue": "TikTok", "count": 1, "percent": 33.3}], "typedValues": [], "allRawAnswers": ["Выбрано: Facebook, TikTok |", "Выбрано: Facebook |"], "averageValue": null}, {"questionId": "q_1742821416026", "questionType": "q103", "title": "Выберите ваш текущий уровень образования:", "chartType": "pie", "answersDetail": [{"answerValue": "Среднее специальное", "count": 1, "percent": 50.0}, {"answerValue": "Неполное высшее", "count": 1, "percent": 50.0}], "typedValues": [], "allRawAnswers": ["Выбрано: Среднее специальное |", "Выбрано: Неполное высшее |"], "averageValue": null}, {"questionId": "q_1742821416355", "questionType": "q104", "title": "Насколько вы удовлетворены следующими аспектами вашей работы?", "chartType": "bar", "answersDetail": [{"answerValue": "ans1742821478515 | ans1742821496370", "count": 1, "percent": 50.0}, {"answerValue": "ans1742821479723 | ans1742821496370", "count": 1, "percent": 50.0}], "typedValues": [], "allRawAnswers": ["ans1742821478515 | ans1742821496370 |", "ans1742821479723 | ans1742821496370 |"], "averageValue": null}, {"questionId": "q_1742821416683", "questionType": "q105", "title": "Какие льготы на работе для вас важны?", "chartType": "bar", "answersDetail": [{"answerValue": "ans1742821524694, ans1742821525902 | ans1742821527509, ans1742821525433", "count": 1, "percent": 50.0}, {"answerValue": "ans1742821524694 | ans1742821526848", "count": 1, "percent": 50.0}], "typedValues": [], "allRawAnswers": ["ans1742821524694, ans1742821525902 | ans1742821527509, ans1742821525433 |", "ans1742821524694 | ans1742821526848 |"], "averageValue": null}, {"questionId": "q_1742821417011", "questionType": "q201", "title": "Выберите логотип, который вам нравится больше всего.", "chartType": null, "answersDetail": [{"answerValue": "", "count": 2, "percent": 100.0}], "typedValues": [], "allRawAnswers": ["Выбрано:  |", "Выбрано:  |"], "averageValue": null}, {"questionId": "q_1742821417519", "questionType": "q202", "title": "Отметьте фотографии, которые вам нравятся.", "chartType": null, "answersDetail": [{"answerValue": "", "count": 3, "percent": 100.0}], "typedValues": [], "allRawAnswers": ["Выбрано: ,  |", "Выбрано:  |"], "averageValue": null}, {"questionId": "q_1742821417930", "questionType": "q301", "title": "Сколько чашек кофе вы выпиваете в день?", "chartType": null, "answersDetail": [], "typedValues": ["5", "3"], "allRawAnswers": [], "averageValue": 4.0}, {"questionId": "q_1742821418317", "questionType": "q302", "title": "Сколько литров воды вы выпиваете в день (введите с точностью до десятых)?", "chartType": null, "answersDetail": [], "typedValues": ["1.4", "3"], "allRawAnswers": [], "averageValue": 2.2}, {"questionId": "q_1742821418751", "questionType": "q303", "title": " Назовите ваш любимый фильм.", "chartType": null, "answersDetail": [], "typedValues": ["fdg", "3"], "allRawAnswers": [], "averageValue": null}, {"questionId": "q_1742821419255", "questionType": "q304", "title": "Опишите, что делает вас счастливым.", "chartType": null, "answersDetail": [], "typedValues": ["fg", "3"], "allRawAnswers": [], "averageValue": null}, {"questionId": "q_1742821419696", "questionType": "q305", "title": "Расскажите, как вы справляетесь со стрессом.", "chartType": null, "answersDetail": [], "typedValues": ["df", "2"], "allRawAnswers": [], "averageValue": null}, {"questionId": "q_1742821420095", "questionType": "q306", "title": "Назовите 3 ваших хобби.", "chartType": "bar", "answersDetail": [{"answerValue": "field_0=d", "count": 1, "percent": 16.7}, {"answerValue": "field_1=f", "count": 1, "percent": 16.7}, {"answerValue": "field_2=g", "count": 1, "percent": 16.7}, {"answerValue": "field_0=3", "count": 1, "percent": 16.7}, {"answerValue": "field_1=2", "count": 1, "percent": 16.7}, {"answerValue": "field_2=3", "count": 1, "percent": 16.7}], "typedValues": [], "allRawAnswers": ["field_0=d | field_1=f | field_2=g |", "field_0=3 | field_1=2 | field_2=3 |"], "averageValue": null}, {"questionId": "q_1742821420529", "questionType": "q401", "title": "Оцените уровень вашей удовлетворенности:", "chartType": "bar", "answersDetail": [{"answerValue": "selected_scale=Средний", "count": 1, "percent": 50.0}, {"answerValue": "selected_scale=Очень низкий", "count": 1, "percent": 50.0}], "typedValues": [], "allRawAnswers": ["selected_scale=Средний |", "selected_scale=Очень низкий |"], "averageValue": null}, {"questionId": "q_1742821420897", "questionType": "q402", "title": "Как вы оцениваете качество нашего сервиса?", "chartType": "bar", "answersDetail": [{"answerValue": "selected_scale=Высокий", "count": 1, "percent": 50.0}, {"answerValue": "selected_scale=Очень высокий", "count": 1, "percent": 50.0}], "typedValues": [], "allRawAnswers": ["selected_scale=Высокий |", "selected_scale=Очень высокий |"], "averageValue": null}, {"questionId": "q_1742821421350", "questionType": "q403", "title": "Насколько вы уверены в своих знаниях (0-10)?", "chartType": "bar", "answersDetail": [{"answerValue": "sliderIndex=3", "count": 1, "percent": 50.0}, {"answerValue": "sliderIndex=4", "count": 1, "percent": 50.0}], "typedValues": [], "allRawAnswers": ["sliderIndex=3 |", "sliderIndex=4 |"], "averageValue": null}, {"questionId": "q_1742821421807", "questionType": "q404", "title": "Насколько вам понравился вебинар (0-10)?", "chartType": "bar", "answersDetail": [{"answerValue": "sliderIndex=3", "count": 1, "percent": 50.0}, {"answerValue": "sliderIndex=2", "count": 1, "percent": 50.0}], "typedValues": [], "allRawAnswers": ["sliderIndex=3 |", "sliderIndex=2 |"], "averageValue": null}, {"questionId": "q_1742821422268", "questionType": "q405", "title": " Оцените фильм, который вы недавно посмотрели", "chartType": "bar", "answersDetail": [{"answerValue": "starValue=5", "count": 1, "percent": 50.0}, {"answerValue": "starValue=4", "count": 1, "percent": 50.0}], "typedValues": [], "allRawAnswers": ["starValue=5 |", "starValue=4 |"], "averageValue": null}, {"questionId": "q_1742821422675", "questionType": "q501", "title": "Укажите уровень владения языками", "chartType": "bar", "answersDetail": [{"answerValue": "c2 | c4 | c2", "count": 1, "percent": 50.0}, {"answerValue": "c2 | c3 | c3", "count": 1, "percent": 50.0}], "typedValues": [], "allRawAnswers": ["c2 | c4 | c2 |", "c2 | c3 | c3 |"], "averageValue": null}, {"questionId": "q_1742821423089", "questionType": "q502", "title": "Какие навыки вы используете на работе?", "chartType": "bar", "answersDetail": [{"answerValue": "c1, c2 | c3 | c0", "count": 1, "percent": 50.0}, {"answerValue": "c3 | c3 | c3", "count": 1, "percent": 50.0}], "typedValues": [], "allRawAnswers": ["c1, c2 | c3 | c0 |", "c3 | c3 | c3 |"], "averageValue": null}, {"questionId": "q_1742821423566", "questionType": "q503", "title": "Какая роль вам ближе?", "chartType": "bar", "answersDetail": [{"answerValue": "0, 1", "count": 2, "percent": 100.0}], "typedValues": [], "allRawAnswers": ["0, 1 |", "0, 1 |"], "averageValue": null}, {"questionId": "q_1742821424008", "questionType": "q504", "title": "В каких ролях вы уже пробовали себя?", "chartType": "bar", "answersDetail": [{"answerValue": "0, 1", "count": 2, "percent": 100.0}], "typedValues": [], "allRawAnswers": ["0, 1 |", "0, 1 |"], "averageValue": null}, {"questionId": "q_1742821424422", "questionType": "q505", "title": "Какой транспорт вы используете?", "chartType": "bar", "answersDetail": [{"answerValue": "1, 2", "count": 1, "percent": 50.0}, {"answerValue": "1", "count": 1, "percent": 50.0}], "typedValues": [], "allRawAnswers": ["1, 2 |", "1 |"], "averageValue": null}, {"questionId": "q_1742821424931", "questionType": "q506", "title": "Какой основной вид транспорта вы используете?", "chartType": "bar", "answersDetail": [{"answerValue": "1, 2", "count": 1, "percent": 50.0}, {"answerValue": "1", "count": 1, "percent": 50.0}], "typedValues": [], "allRawAnswers": ["1, 2 |", "1 |"], "averageValue": null}, {"questionId": "q_1742821425361", "questionType": "q507", "title": "Согласны ли вы с утверждениями?", "chartType": "bar", "answersDetail": [{"answerValue": "yes | no", "count": 2, "percent": 100.0}], "typedValues": [], "allRawAnswers": ["yes | no |", "yes | no |"], "averageValue": null}]};

            window.addEventListener("DOMContentLoaded", () => {
                // Общая диаграмма
                const c1 = document.getElementById("overallChart").getContext("2d");
                new Chart(c1, {
                  type: 'bar',
                  data: {
                    labels: ['Приглашены','Пройдено','Отложено','В процессе'],
                    datasets: [{
                      label: 'Респонденты',
                      data: [
                        analyticsData.invited_count,
                        analyticsData.completed_count,
                        analyticsData.postponed_count,
                        analyticsData.in_progress_count
                      ]
                    }]
                  },
                  options: {
                    responsive: true,
                    scales: {
                      y: { beginAtZero: true }
                    }
                  }
                });

                // Вывод вопросов
                const questionsBlock = document.getElementById("questionsBlock");

                analyticsData.question_analytics.forEach((q, idx) => {
                    const qDiv = document.createElement("div");
                    qDiv.className = "question-block";
                    qDiv.innerHTML = `
                      <h2>Вопрос #${idx+1}: ${q.title}</h2>
                      <p><b>ID:</b> ${q.questionId}, <b>Тип:</b> ${q.questionType}</p>
                    `;

                    // Сырые ответы (allRawAnswers)
                    if (Array.isArray(q.allRawAnswers) && q.allRawAnswers.length > 0) {
                        let rawHtml = "<h4>Сырые ответы (читаемые):</h4><ul>";
                        q.allRawAnswers.forEach(r => {
                            // Если хотите дополнительно проверять, не ли там (Изображение) и делать <img>, можно здесь
                            rawHtml += `<li>${r}</li>`;
                        });
                        rawHtml += "</ul>";
                        qDiv.innerHTML += rawHtml;
                    }

                    // typedValues (например, q301..q305)
                    if (Array.isArray(q.typedValues) && q.typedValues.length > 0) {
                        let tvHtml = "<h4>Тексты (введённые значения):</h4><ul>";
                        q.typedValues.forEach(tv => {
                            tvHtml += `<li>${tv}</li>`;
                        });
                        tvHtml += "</ul>";
                        qDiv.innerHTML += tvHtml;
                    }

                    // Если хотим показать агрегированную статистику
                    // (можно отключить для таблиц/множественных, если не нужно)
                    if (q.answersDetail && q.answersDetail.length > 0) {
                        let tableHtml = `
                          <table class="answer-stats">
                            <thead>
                              <tr><th>Ответ</th><th>Кол-во</th><th>%</th></tr>
                            </thead>
                            <tbody>
                        `;
                        q.answersDetail.forEach(a => {
                            tableHtml += `
                              <tr>
                                <td>${a.answerValue}</td>
                                <td>${a.count}</td>
                                <td>${a.percent}</td>
                              </tr>
                            `;
                        });
                        tableHtml += "</tbody></table>";
                        qDiv.innerHTML += tableHtml;
                    }

                    // Строим диаграмму?
                    if (q.chartType === null) {
                        // Нет диаграммы
                        const p = document.createElement("p");
                        p.textContent = "Для данных вопросов не нужны диаграммы";
                        qDiv.appendChild(p);
                    } else {
                        // Рисуем Chart.js
                        const cDiv = document.createElement("div");
                        cDiv.className = "chart-container";
                        const canvasId = `qchart_${idx}`;
                        cDiv.innerHTML = `<canvas id="${canvasId}"></canvas>`;
                        qDiv.appendChild(cDiv);

                        setTimeout(() => {
                            const ctx = document.getElementById(canvasId).getContext("2d");
                            const labels = q.answersDetail.map(d => d.answerValue);
                            const dataVals = q.answersDetail.map(d => d.count);
                            new Chart(ctx, {
                                type: q.chartType,
                                data: {
                                    labels: labels,
                                    datasets: [{
                                        label: 'Ответы',
                                        data: dataVals
                                    }]
                                },
                                options: {
                                    responsive: true,
                                    scales: (q.chartType === 'pie') ? {} : {
                                        y: { beginAtZero: true }
                                    }
                                }
                            });
                        }, 0);
                    }

                    questionsBlock.appendChild(qDiv);
                });
            });
          </script>
        </body>
        </html>
        